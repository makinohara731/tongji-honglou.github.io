<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>大观园社区 - 同济红楼社</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/style.css">
    <script>tailwind.config = { theme: { extend: { colors: { 'red-dream': '#A62424', 'rice': '#F5F0E6', 'ink': '#2D2D2D' }, fontFamily: { 'song': ['SimSun', 'serif'] } } } }</script>
    <style>.channel-active { background-color: #FEF2F2; border-right: 4px solid #A62424; color: #A62424; font-weight: bold; }</style>
</head>
<body class="bg-rice font-song text-ink h-screen flex flex-col overflow-hidden">

    <!-- Navbar 自动插入在这里 -->
    
    <div class="flex flex-1 container mx-auto max-w-7xl md:px-4 h-full pt-4 pb-4 gap-4 overflow-hidden">
        
        <!-- 左侧导航 -->
        <aside class="w-full md:w-64 bg-white md:rounded-lg shadow flex flex-col hidden md:flex border-r">
            <div class="p-4 border-b font-bold text-lg text-center bg-red-dream text-white md:rounded-t-lg">
                大观园频道
            </div>
            <nav class="flex-1 overflow-y-auto py-2 space-y-1 p-2">
                <button onclick="changeChannel('yihong', '怡红院 · 灌水闲聊', this)" class="channel-btn w-full text-left px-4 py-3 rounded hover:bg-gray-50 flex items-center transition">
                    <i class="fa fa-coffee w-8"></i> 怡红院 (闲聊)
                </button>
                <button onclick="changeChannel('xiaoxiang', '潇湘馆 · 原创天地', this)" class="channel-btn w-full text-left px-4 py-3 rounded hover:bg-gray-50 flex items-center transition">
                    <i class="fa fa-pencil w-8"></i> 潇湘馆 (创作)
                </button>
                <button onclick="changeChannel('daoxiang', '稻香村 · 考据辩论', this)" class="channel-btn w-full text-left px-4 py-3 rounded hover:bg-gray-50 flex items-center transition">
                    <i class="fa fa-book w-8"></i> 稻香村 (考据)
                </button>
                <button onclick="changeChannel('shengqin', '省亲别墅 · 建议反馈', this)" class="channel-btn w-full text-left px-4 py-3 rounded hover:bg-gray-50 flex items-center transition">
                    <i class="fa fa-bullhorn w-8"></i> 省亲别墅 (建议)
                </button>
            </nav>
        </aside>

        <!-- 右侧内容区 -->
        <main class="flex-1 bg-white md:rounded-lg shadow flex flex-col overflow-hidden relative">
            <header class="p-4 border-b bg-white flex justify-between items-center shadow-sm z-10">
                <div>
                    <h2 id="channel-title" class="text-lg font-bold text-red-dream">请选择频道</h2>
                </div>
                <!-- 手机切换按钮 -->
                <button class="md:hidden border px-3 py-1 rounded bg-gray-100" onclick="document.querySelector('aside').classList.toggle('hidden');document.querySelector('aside').classList.toggle('absolute');document.querySelector('aside').classList.toggle('h-full');document.querySelector('aside').classList.toggle('z-50');">
                    <i class="fa fa-list"></i> 频道
                </button>
            </header>

            <div class="flex-1 overflow-y-auto p-4 bg-gray-50 scroll-smooth" id="giscus-wrapper">
                <div class="giscus"></div>
            </div>
        </main>
    </div>

    <script src="js/config.js"></script>
    <script src="js/navbar.js"></script>
    <script src="js/utils.js"></script>
    <script>
        function changeChannel(term, title, btn) {
            // UI 更新
            document.querySelectorAll('.channel-btn').forEach(b => b.classList.remove('channel-active'));
            if(btn) btn.classList.add('channel-active');
            document.getElementById('channel-title').innerText = title;
            
            // 加载评论
            loadGiscus('.giscus', term, 'specific');

            // 手机端自动收起侧边栏
            if(window.innerWidth < 768) {
                document.querySelector('aside').classList.add('hidden');
                document.querySelector('aside').classList.remove('absolute', 'h-full', 'z-50');
            }
        }

        // 初始化默认频道
        window.addEventListener('load', () => {
            const firstBtn = document.querySelector('.channel-btn');
            if(firstBtn) firstBtn.click();
        });
    </script>
</body>
</html>
